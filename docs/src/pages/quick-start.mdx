import { Callout } from 'nextra-theme-docs'

# 快速开始

## 准备环境

Mahiro 本体需要运行在 Nodejs 上，在安装依赖时进行编译，还需具备 Python 环境。

我们推荐准备以下环境：

- Node.js **_v18+_**

- Python **_v3.8+_**

## 快速上手

### 创建项目

我们将创建一个最简 Mahiro 项目：

```bash
  # 加速源
  npm config set registry https://registry.npmmirror.com/
  npm i -g pnpm

  # 在当前目录下创建一个最简项目模板
  pnpm create mahiro
```

选择并创建一个 `Simple` 项目，安装依赖： 

```bash
  cd my-mahiro
  pnpm i
```

注：在第一次安装时，`sqlite` 编译需一定时间，请耐心等待，如无法安装成功，请确保你配置了 [加速源](./faq##mahiro-安装缓慢--无法安装成功) 相关配置。

### 修改配置

初始化得到的目录结构如下：

```bash filename="目录结构"
 - my-mahiro
   - package.json
   - index.ts
   - .account.json
   - .npmrc
```

为了安全，我们不将账号信息写入代码（ `index.ts` ）中，而是单独置于 `.account.json` 文件内：

```json filename=".account.json"
{
  "account": 123456789,
  "host": "localhost",
  "port": 8086
}
```

将 `account` 修改为你的账号即可。

### 启动程序

启动 Mahiro ：

```bash
  pnpm start
```

```bash filename="终端输出"
      ___           ___           ___                       ___           ___
     /__/\         /  /\         /__/\        ___          /  /\         /  /\
    |  |::\       /  /::\        \  \:\      /  /\        /  /::\       /  /::\
    |  |:|:\     /  /:/\:\        \__\:\    /  /:/       /  /:/\:\     /  /:/\:\
  __|__|:|\:\   /  /:/~/::\   ___ /  /::\  /__/::\      /  /:/~/:/    /  /:/  \:\
 /__/::::| \:\ /__/:/ /:/\:\ /__/\  /:/\:\ \__\/\:\__  /__/:/ /:/___ /__/:/ \__\:\
 \  \:\~~\__\/ \  \:\/:/__\/ \  \:\/:/__\/    \  \:\/\ \  \:\/:::::/ \  \:\ /  /:/
  \  \:\        \  \::/       \  \::/          \__\::/  \  \::/~~~~   \  \:\  /:/
   \  \:\        \  \:\        \  \:\          /__/:/    \  \:\        \  \:\/:/
    \  \:\        \  \:\        \  \:\         \__\/      \  \:\        \  \::/
     \__\/         \__\/         \__\/                     \__\/         \__\/

ℹ Mahiro is starting...
ℹ Try connect...
✔ WS Connected ws://127.0.0.1:8086/ws
ℹ [Database] Connecting...
ℹ [Database] Connected
ℹ Register onGroupMessage:  [Node Server] Python Forward - Group Message
ℹ Register onFriendMessage:  [Node Server] Python Forward - Friend Message
ℹ [Web Site] Start at  http://localhost:8098
```

### 配置群组

在 Mahiro 中，出于安全考量，**一切均为白名单设计**。

故必须配置群组后才可使用相关功能，打开控制台打印的 Mahiro 面板地址：`http://localhost:8098` （注意放通防火墙与安全组，运行在服务器上时，请替换为服务器公网 IP）。

在首页输入当前主账号，获得面板访问权限。

之后在 **群组管理** 添加一个新的群组：

<br />

<img src="/imgs/config-group.webp" alt="config-group" width="100%" />

至此，我们已经完成了最简的收发消息项目，你可以在对应群组发送 `Hello` 查看触发情况。

<Callout type="info" emoji="ℹ️">
  注：仅群组必须配置后才可使用，Friend 消息功能无权限限制。
</Callout>

## 学到更多

Mahiro 可以在消息的生命周期上进行干预，来做到拦截、限制等：

 - 了解消息 [生命周期模型](./lifecycle)
 - 进一步了解 [管理面板](./panel)
 - 对接 [Python](./python) 插件
